*pyrepl.txt*  Python REPL for Neovim (pyrepl.nvim by dangooddd)

==============================================================================
INTRODUCTION                                                     *pyrepl*

pyrepl.nvim provides a Python REPL inside Neovim using the Jupyter kernel
stack. It lets you send code from buffers, see results immediately, and view
image outputs when image.nvim is installed.

Project: https://github.com/dangooddd/pyrepl.nvim

==============================================================================
REQUIREMENTS                                                   *pyrepl-reqs*

- Neovim Python provider configured (see |provider-python|).
- The Python interpreter set in g:python3_host_prog must have these packages:
  - pynvim
  - jupyter-client
  - prompt-toolkit
  - pillow
  - pygments
  - ipykernel
- A Jupyter kernel registered:
>
  python3 -m pip install ipykernel
  python3 -m ipykernel install --user --name python3
<
- Tree-sitter Python parser (required for |pyrepl.send_statement|).
- Image rendering requires image.nvim and its dependencies.
- pyrepl.nvim does not auto-install dependencies.

==============================================================================
COMMANDS                                                        *pyrepl-commands*


:PyREPLOpen                                                     *PyREPLOpen*
    Start (or attach to) a REPL for the current buffer. When invoked, you are
    prompted to select a Jupyter kernel. The REPL opens in a split terminal.
    Each buffer has its own kernel session.

    Notes:
    - Buffer-local command, available for any filetype.
    - Requires :UpdateRemotePlugins after installation.
    - Closing the buffer shuts down its kernel and closes its terminal.
    - Closing the REPL terminal only clears the terminal and keeps the kernel.

:PyREPLHide                                                     *PyREPLHide*
    Hide the REPL window for the current buffer. Keeps the REPL buffer and
    kernel alive.

:PyREPLClose                                                    *PyREPLClose*
    Close the REPL buffer for the current buffer. Shuts down the kernel.

:PyREPLSendVisual                                               *PyREPLSendVisual*
    Send the last visual selection to the REPL.

:PyREPLSendStatement                                            *PyREPLSendStatement*
    Send the top-level statement under the cursor using Tree-sitter.

:PyREPLSendBuffer                                               *PyREPLSendBuffer*
    Send the entire buffer to the REPL.

:PyREPLOpenImages                                               *PyREPLOpenImages*
    Open the images manager.


==============================================================================
LUA API                                                         *pyrepl-api*

require("pyrepl").setup({opts})                                 *pyrepl.setup*
    Configure pyrepl.nvim and register :PyREPLOpen. Returns the module table.

require("pyrepl").open_repl()                                   *pyrepl.open_repl*
    Same as :PyREPLOpen. Starts kernel selection and opens the REPL.

require("pyrepl").hide_repl()                                   *pyrepl.hide_repl*
    Same as :PyREPLHide. Hides the REPL window.

require("pyrepl").close_repl()                                  *pyrepl.close_repl*
    Same as :PyREPLClose. Closes the REPL buffer and shuts down the kernel.

require("pyrepl").send_statement()                              *pyrepl.send_statement*
    Send the top-level statement under the cursor using Tree-sitter.

require("pyrepl").send_visual()                                 *pyrepl.send_visual*
    Send the last visual selection to the REPL. This uses the '< and '>
    marks, so it works with mappings like :<C-u>PyREPLSendVisual<CR>gv.

require("pyrepl").send_buffer()                                 *pyrepl.send_buffer*
    Send the entire buffer to the REPL.

require("pyrepl").open_images()                                 *pyrepl.open_images*
    Open the images manager.


==============================================================================
CONFIGURATION                                                   *pyrepl-config*

Default configuration:
>
  require("pyrepl").setup({
    split_horizontal = false,
    split_ratio = 0.5,
    style = "default",
    image_max_width_ratio = 0.4,
    image_max_height_ratio = 0.5,
  })
<

Options:
  split_horizontal (boolean)
      Use a horizontal split for the REPL terminal. Default: false.
  split_ratio (number)
      Fraction of screen used by the REPL split. Default: 0.5.
  style (string)
      Pygments style name for REPL syntax highlighting. Default: "default".
  image_max_width_ratio (number)
      Target image width as a fraction of editor columns. Default: 0.4.
      Used for sizing the render box and can upscale images.
  image_max_height_ratio (number)
      Target image height as a fraction of editor lines. Default: 0.5.
      Used for sizing the render box and can upscale images.

Example with keymaps:
>
  {
      "dangooddd/pyrepl.nvim",
      dependencies = {
          "nvim-treesitter/nvim-treesitter",
          "3rd/image.nvim",
      },
      build = ":UpdateRemotePlugins",
      config = function()
          local pyrepl = require("pyrepl")

          pyrepl.setup({
              style = "gruvbox-dark",
          })

          vim.keymap.set("n", "<leader>jo", ":PyREPLOpen<CR>", { silent = true })
          vim.keymap.set("n", "<leader>jh", ":PyREPLHide<CR>", { silent = true })
          vim.keymap.set("n", "<leader>jc", ":PyREPLClose<CR>", { silent = true })
          vim.keymap.set("n", "<leader>js", ":PyREPLSendStatement<CR>", { silent = true })
          vim.keymap.set("n", "<leader>jb", ":PyREPLSendBuffer<CR>", { silent = true })
          vim.keymap.set("v", "<leader>jv", ":<C-u>PyREPLSendVisual<CR>gv", { silent = true })
          vim.keymap.set("n", "<leader>ji", ":PyREPLOpenImages<CR>", { silent = true })
      end,
  }
<

==============================================================================
IMAGES                                                         *pyrepl-images*

Image rendering requires image.nvim and its dependencies:
https://github.com/3rd/image.nvim

Supported image formats and backends are whatever image.nvim supports.

The images manager can be opened with:
>
  require("pyrepl").open_images()
<

While focused in the image window:
  h     previous image
  l     next image
  q     close window
  <Esc> close window

==============================================================================
HIGHLIGHTS                                                     *pyrepl-highlights*

pyrepl.nvim defines these highlight groups (linked by default):
  PyREPLImageBorder
  PyREPLImageTitle
  PyREPLImageNormal

Override example:
>
  vim.api.nvim_set_hl(0, "PyREPLImageBorder", { link = "FloatBorder" })
  vim.api.nvim_set_hl(0, "PyREPLImageTitle", { link = "FloatTitle" })
  vim.api.nvim_set_hl(0, "PyREPLImageNormal", { link = "NormalFloat" })
<

==============================================================================
TROUBLESHOOTING                                                *pyrepl-troubleshooting*

- Ensure your Python provider is configured. If needed, set:
>
  let g:python3_host_prog = "/path/to/python3"
<
- Install required Python packages into that interpreter (see |pyrepl-reqs|).
- After installing, run :UpdateRemotePlugins and restart Neovim.
- If no kernels are found, install ipykernel and register a kernel:
>
  python3 -m pip install ipykernel
  python3 -m ipykernel install --user --name python3
<
- If images do not render, verify image.nvim dependencies and terminal backend
  support.

==============================================================================
END

vim:tw=78:ts=8:noet:ft=help:norl:
